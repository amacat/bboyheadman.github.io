<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
	<title>Over Game</title>
	<script type="text/javascript" src="../jq/jquery.min.js"></script>
	<link rel="stylesheet" type="text/css" href="main.css">
	<style type="text/css">
		.circle{
			position:fixed;
			/*background-color:white;*/
			transition-duration:1s;
			width:50px;
			height:50px;
			/*top:calc(50% - 25px);*/
			top:100%;
			left:calc(50% - 25px);

		}
		h1{
			padding: 5px;
		}
		.start{
			position: fixed;
			text-align: center;
			width:100px;
			height:20px;
			top:calc(50% - 10px);
			left:calc(50% - 50px);
			font-size: 20px;
			cursor: pointer;
		}
	</style>
</head>
<body>
<h1 class="total">Total: 0$</h1>
<h1 class="bestScore">Record: 0$</h1>
<div class="start">Start</div>
<div class="circle"><img src="dog.png" width="50px"></div>

<script type="text/javascript">
var total = 0;
var best = 0;
function gameOver() {
	alert("Game Over\nYou steal "+total+"$.");
	$(".total").text("Total: 0$");
	setBestScore();
	$(".start").slideDown(100);
}

function randomInteger(min, max) {
	var rand = min + Math.random() * (max - min);
	rand = Math.round(rand);
	return rand;
}

function setBestScore() {
	if (total > best){
		$.ajax({
			url: "http://bboyheadman.tk/games/score.php",
			dataType: "html",
			data: {set: total},
			success: function(data){
				console.log(data);
				getBestScore();
			}
		});
	}
	total = 0;
}

function getBestScore() {
	$.ajax({
		url: "http://bboyheadman.tk/games/score.php",
		dataType: "html",
		data: {get: 1},
		success: function(data){
			console.log(data);
			$(".bestScore").text("Record: "+data+"$");
			best = parseInt(data);
		}
	});
}

$("document").ready(function(){
	getBestScore();
	
	$(".start").bind("click", function(){
		$(this).slideUp(100);
		$(".circle").css({"top":"50%"});
	});

	$(document).on("mouseover", ".circle", function(){
		var leftPos = randomInteger(0,100);
		var topPos = randomInteger(0,100);
		$(".circle").css({
			"left": leftPos+"%",
			"top": topPos+"%"
		});
		if(leftPos == 100 || topPos == 100){
			gameOver();
		}
	});

	$("img").bind("click", function(){
		total+=100;
		$(".total").text("Total: "+total+"$");
		// if (total > 2){
			// alert('Пошел нахуй');
		// }
	});

})
</script>
</body>
</html>